function r(e,t,n,a,i){var d;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d.onreadystatechange=function(){4==d.readyState&&200==d.status&&(e?i(d.responseText,a):i(JSON.parse(d.responseText)))},d.open(e?"POST":"GET",t,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send(n)}function a(){var e,t;e=document.getElementById("g"),t=document.getElementById("c"),r(!1,"check/"+(null!=e.innerHTML?e.innerHTML:"")+"/"+(null!=t.innerHTML?t.innerHTML:""),null,null,b)}function b(t){if(null!=t&&"0"!=t){var n,i,d,l,s,r,o,c,u;for(i=document.getElementById("l"),d=document.getElementsByClassName("re"),n=0;n<d.length;n++)d[n].outerHTML="";for(n=0;n<t.c.length;n++)c=t.c[n],o=""!=c.a?c.a+" - ":"",document.getElementById("h").insertAdjacentHTML("afterbegin",'<a href="conversations/display/'+c.g+"/"+c.c+'#l"><div class="f"><div class="i">'+o+c.u+'</div><div class="cc j fr" data-md="">'+h(c.d)+' &nbsp;<a href="delete-conversation/'+c.c+'"><div class="g id ac" alt="Delete Conversation" title="Delete Conversation"></div></a></div><div class="z"></div></a>');for(n=0;n<t.m.length;n++)s=t.m[n],r=1==s.f?"fr":"fl",u=1==s.f?"s":"r",u=1==s.s?u+=" ae":u,l=1==s.s?'<div class="ad">-= Message has been tampered with =-</div>':"",i.insertAdjacentHTML("beforebegin",'<div class="o '+r+'"><div class="q '+u+'">'+l+s.m+'</div><div class="z j aa '+r+'" data-md="'+s.r+'">'+s.d+'</div></div><div class="p"></div>');e("l")}a()}function c(){var e=document.getElementById("m");return e.value.length>0&&!/^\s+$/.test(e.value)&&(r(!0,"send","g="+document.getElementById("g").innerHTML+"&c="+document.getElementById("c").innerHTML+"&m="+e.value,e.value,d),e.value="",e.select()),!1}function d(t,n){1==t&&(document.getElementById("l").insertAdjacentHTML("beforebegin",'<div class="re o fr"><div class="q s fr">'+n.replace(new RegExp("\n","g"),"<br/>")+'</div><div class="z j aa fr">now</div></div><div class="re p"></div>'),e("l"))}function e(e){var t=document.getElementById(e);null!=t&&t.scrollIntoView()}function f(e){var t,n,a,i,d,l;for(t=["second","minute","hour","day","week","month","year"],n=[60,60,24,7,4.35,12,10],a=Math.floor(new Date/1e3),e=Math.floor(new Date(e)/1e3),i=a-e,d="ago",l=0;i>=n[l]&&l<t.length;l++)i/=n[l];return i=Math.round(i),1!=i&&(t[l]+="s"),i+" "+t[l]+" "+d}function g(){var e,t,n;for(e=document.getElementsByClassName("z j"),t=0,n=e.length-1;n>0&&20>t;n--)e[n].innerHTML=f(e[n].getAttribute("data-md")),t++}function h(e){var t,n,a,d,l,s,r;return t=(new Date).toLocaleString("en-GB",{hour12:!0}),n=new Date(e).toLocaleString("en-GB",{hour12:!0}),a=n.split("/"),l=t.split("/"),d=n.toUpperCase().split(",")[1].split(":"),s=i(d[0].trim())+":"+d[1]+" "+d[2].split(" ")[1],r=i(a[0])+"/"+i(a[1]),i(l[0])+"/"+i(l[1])==r?s:r+" "+s}function i(e){return e.length>1?e:"0"+e}function j(){13!=event.keyCode||event.shiftKey||(""==document.getElementById("c").innerHTML?document.getElementById("s").submit():c())}e("l"),a(),document.getElementById("m").addEventListener("keyup",j),setInterval(g,3e4);