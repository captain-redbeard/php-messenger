function r(e,t,n,i,a){var l;l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),l.onreadystatechange=function(){4==l.readyState&&200==l.status&&(e?a(l.responseText,i):a(JSON.parse(l.responseText)))},l.open(e?"POST":"GET",t,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(n)}function a(){var e,t;e=document.getElementById("g"),t=document.getElementById("c"),r(!1,"check/"+(null!=e.innerHTML?e.innerHTML:"")+"/"+(null!=t.innerHTML?t.innerHTML:""),null,null,b)}function b(t){if(null!=t&&"0"!=t){var n,i,l,d,r,s,o,c;for(i=document.getElementById("l"),l=document.getElementsByClassName("re"),n=0;n<l.length;n++)l[n].outerHTML="";for(n=0;n<t.c.length;n++)o=t.c[n],s=""!=o.a?o.a+" - ":"",document.getElementById("h").insertAdjacentHTML("afterbegin",'<a href="conversations/display/'+o.g+"/"+o.c+'#l"><div class="f"><div class="i">'+s+o.u+'</div><div class="cc j fr" data-md="">'+h(o.d)+' &nbsp;<a href="delete-conversation/'+o.c+'"><div class="g id" alt="Delete Conversation" title="Delete Conversation" style="width: 10px; height: 10px;"></div></a></div><div class="z"></div></a>');for(n=0;n<t.m.length;n++)d=t.m[n],r=1==d.f?"fr":"fl",c=1==d.f?"s":"r",i.insertAdjacentHTML("beforebegin",'<div class="o '+r+'"><div class="q '+c+'">'+d.m+'</div><div class="z j aa '+r+'" data-md="'+d.r+'">'+d.d+'</div></div><div class="p"></div>');e("l")}a()}function c(){var e=document.getElementById("m");return e.value.length>0&&!/^\s+$/.test(e.value)&&(r(!0,"send","g="+document.getElementById("g").innerHTML+"&c="+document.getElementById("c").innerHTML+"&m="+e.value,e.value,d),e.value="",e.select()),!1}function d(t,n){1==t&&(document.getElementById("l").insertAdjacentHTML("beforebegin",'<div class="re o fr"><div class="q s fr">'+n.replace(new RegExp("\n","g"),"<br/>")+'</div><div class="z j aa fr">now</div></div><div class="re p"></div>'),e("l"))}function e(e){var t=document.getElementById(e);null!=t&&t.scrollIntoView()}function f(e){var t,n,i,a,l,d;for(t=["second","minute","hour","day","week","month","year"],n=[60,60,24,7,4.35,12,10],i=Math.floor(new Date/1e3),e=Math.floor(new Date(e)/1e3),a=i-e,l="ago",d=0;a>=n[d]&&d<t.length;d++)a/=n[d];return a=Math.round(a),1!=a&&(t[d]+="s"),a+" "+t[d]+" "+l}function g(){var e,t,n;for(e=document.getElementsByClassName("z j"),t=0,n=e.length-1;n>0&&20>t;n--)e[n].innerHTML=f(e[n].getAttribute("data-md")),t++}function h(e){var t,n,a,l,d,r,s;return t=(new Date).toLocaleString("en-GB",{hour12:!0}),n=new Date(e).toLocaleString("en-GB",{hour12:!0}),a=n.split("/"),d=t.split("/"),l=n.toUpperCase().split(",")[1].split(":"),r=i(l[0].trim())+":"+l[1]+" "+l[2].split(" ")[1],s=i(a[0])+"/"+i(a[1]),i(d[0])+"/"+i(d[1])==s?r:s+" "+r}function i(e){return e.length>1?e:"0"+e}function j(){13!=event.keyCode||event.shiftKey||(""==document.getElementById("c").innerHTML?document.getElementById("s").submit():c())}e("l"),a(),document.getElementById("m").addEventListener("keyup",j),setInterval(g,3e4);